{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useCallback } from 'react';\nimport { useWeb3React, UnsupportedChainIdError } from '@web3-react/core';\nimport { NoBscProviderError } from '@binance-chain/bsc-connector';\nimport { NoEthereumProviderError, UserRejectedRequestError as UserRejectedRequestErrorInjected } from '@web3-react/injected-connector';\nimport { UserRejectedRequestError as UserRejectedRequestErrorWalletConnect, WalletConnectConnector } from '@web3-react/walletconnect-connector';\nimport { connectorLocalStorageKey } from '@pancakeswap/uikit';\nimport { connectorsByName } from 'utils/web3React';\nimport { setupNetwork } from 'utils/wallet';\nimport useToast from 'hooks/useToast';\nimport { profileClear } from 'state/profile';\nimport { useAppDispatch } from 'state';\n\nconst useAuth = () => {\n  _s();\n\n  const dispatch = useAppDispatch();\n  const {\n    activate,\n    deactivate\n  } = useWeb3React();\n  const {\n    toastError\n  } = useToast();\n  const login = useCallback(connectorID => {\n    const connector = connectorsByName[connectorID];\n\n    if (connector) {\n      activate(connector, async error => {\n        if (error instanceof UnsupportedChainIdError) {\n          const hasSetup = await setupNetwork();\n\n          if (hasSetup) {\n            activate(connector);\n          }\n        } else {\n          window.localStorage.removeItem(connectorLocalStorageKey);\n\n          if (error instanceof NoEthereumProviderError || error instanceof NoBscProviderError) {\n            toastError('Provider Error', 'No provider was found');\n          } else if (error instanceof UserRejectedRequestErrorInjected || error instanceof UserRejectedRequestErrorWalletConnect) {\n            if (connector instanceof WalletConnectConnector) {\n              const walletConnector = connector;\n              walletConnector.walletConnectProvider = null;\n            }\n\n            toastError('Authorization Error', 'Please authorize to access your account');\n          } else {\n            toastError(error.name, error.message);\n          }\n        }\n      });\n    } else {\n      toastError('Unable to find connector', 'The connector config is wrong');\n    }\n  }, [activate, toastError]);\n  const logout = useCallback(() => {\n    dispatch(profileClear());\n    deactivate(); // This localStorage key is set by @web3-react/walletconnect-connector\n\n    if (window.localStorage.getItem('walletconnect')) {\n      connectorsByName.walletconnect.close();\n      connectorsByName.walletconnect.walletConnectProvider = null;\n    }\n  }, [deactivate, dispatch]);\n  return {\n    login,\n    logout\n  };\n};\n\n_s(useAuth, \"0LuipgLFMn/0l6C9KW1la7HTyJU=\", false, function () {\n  return [useAppDispatch, useWeb3React, useToast];\n});\n\nexport default useAuth;","map":{"version":3,"sources":["/Users/thomas/Documents/PycharmProjects/pancake-frontend/src/hooks/useAuth.ts"],"names":["useCallback","useWeb3React","UnsupportedChainIdError","NoBscProviderError","NoEthereumProviderError","UserRejectedRequestError","UserRejectedRequestErrorInjected","UserRejectedRequestErrorWalletConnect","WalletConnectConnector","connectorLocalStorageKey","connectorsByName","setupNetwork","useToast","profileClear","useAppDispatch","useAuth","dispatch","activate","deactivate","toastError","login","connectorID","connector","error","hasSetup","window","localStorage","removeItem","walletConnector","walletConnectProvider","name","message","logout","getItem","walletconnect","close"],"mappings":";;AAAA,SAASA,WAAT,QAA4B,OAA5B;AACA,SAASC,YAAT,EAAuBC,uBAAvB,QAAsD,kBAAtD;AACA,SAASC,kBAAT,QAAmC,8BAAnC;AACA,SACEC,uBADF,EAEEC,wBAAwB,IAAIC,gCAF9B,QAGO,gCAHP;AAIA,SACED,wBAAwB,IAAIE,qCAD9B,EAEEC,sBAFF,QAGO,qCAHP;AAIA,SAAyBC,wBAAzB,QAAyD,oBAAzD;AACA,SAASC,gBAAT,QAAiC,iBAAjC;AACA,SAASC,YAAT,QAA6B,cAA7B;AACA,OAAOC,QAAP,MAAqB,gBAArB;AACA,SAASC,YAAT,QAA6B,eAA7B;AACA,SAASC,cAAT,QAA+B,OAA/B;;AAEA,MAAMC,OAAO,GAAG,MAAM;AAAA;;AACpB,QAAMC,QAAQ,GAAGF,cAAc,EAA/B;AACA,QAAM;AAAEG,IAAAA,QAAF;AAAYC,IAAAA;AAAZ,MAA2BjB,YAAY,EAA7C;AACA,QAAM;AAAEkB,IAAAA;AAAF,MAAiBP,QAAQ,EAA/B;AAEA,QAAMQ,KAAK,GAAGpB,WAAW,CACtBqB,WAAD,IAAiC;AAC/B,UAAMC,SAAS,GAAGZ,gBAAgB,CAACW,WAAD,CAAlC;;AACA,QAAIC,SAAJ,EAAe;AACbL,MAAAA,QAAQ,CAACK,SAAD,EAAY,MAAOC,KAAP,IAAwB;AAC1C,YAAIA,KAAK,YAAYrB,uBAArB,EAA8C;AAC5C,gBAAMsB,QAAQ,GAAG,MAAMb,YAAY,EAAnC;;AACA,cAAIa,QAAJ,EAAc;AACZP,YAAAA,QAAQ,CAACK,SAAD,CAAR;AACD;AACF,SALD,MAKO;AACLG,UAAAA,MAAM,CAACC,YAAP,CAAoBC,UAApB,CAA+BlB,wBAA/B;;AACA,cAAIc,KAAK,YAAYnB,uBAAjB,IAA4CmB,KAAK,YAAYpB,kBAAjE,EAAqF;AACnFgB,YAAAA,UAAU,CAAC,gBAAD,EAAmB,uBAAnB,CAAV;AACD,WAFD,MAEO,IACLI,KAAK,YAAYjB,gCAAjB,IACAiB,KAAK,YAAYhB,qCAFZ,EAGL;AACA,gBAAIe,SAAS,YAAYd,sBAAzB,EAAiD;AAC/C,oBAAMoB,eAAe,GAAGN,SAAxB;AACAM,cAAAA,eAAe,CAACC,qBAAhB,GAAwC,IAAxC;AACD;;AACDV,YAAAA,UAAU,CAAC,qBAAD,EAAwB,yCAAxB,CAAV;AACD,WATM,MASA;AACLA,YAAAA,UAAU,CAACI,KAAK,CAACO,IAAP,EAAaP,KAAK,CAACQ,OAAnB,CAAV;AACD;AACF;AACF,OAvBO,CAAR;AAwBD,KAzBD,MAyBO;AACLZ,MAAAA,UAAU,CAAC,0BAAD,EAA6B,+BAA7B,CAAV;AACD;AACF,GA/BsB,EAgCvB,CAAEF,QAAF,EAAYE,UAAZ,CAhCuB,CAAzB;AAmCA,QAAMa,MAAM,GAAGhC,WAAW,CAAC,MAAM;AAC/BgB,IAAAA,QAAQ,CAACH,YAAY,EAAb,CAAR;AACAK,IAAAA,UAAU,GAFqB,CAG/B;;AACA,QAAIO,MAAM,CAACC,YAAP,CAAoBO,OAApB,CAA4B,eAA5B,CAAJ,EAAkD;AAChDvB,MAAAA,gBAAgB,CAACwB,aAAjB,CAA+BC,KAA/B;AACAzB,MAAAA,gBAAgB,CAACwB,aAAjB,CAA+BL,qBAA/B,GAAuD,IAAvD;AACD;AACF,GARyB,EAQvB,CAACX,UAAD,EAAaF,QAAb,CARuB,CAA1B;AAUA,SAAO;AAAEI,IAAAA,KAAF;AAASY,IAAAA;AAAT,GAAP;AACD,CAnDD;;GAAMjB,O;UACaD,c,EACgBb,Y,EACVW,Q;;;AAkDzB,eAAeG,OAAf","sourcesContent":["import { useCallback } from 'react'\nimport { useWeb3React, UnsupportedChainIdError } from '@web3-react/core'\nimport { NoBscProviderError } from '@binance-chain/bsc-connector'\nimport {\n  NoEthereumProviderError,\n  UserRejectedRequestError as UserRejectedRequestErrorInjected,\n} from '@web3-react/injected-connector'\nimport {\n  UserRejectedRequestError as UserRejectedRequestErrorWalletConnect,\n  WalletConnectConnector,\n} from '@web3-react/walletconnect-connector'\nimport { ConnectorNames, connectorLocalStorageKey } from '@pancakeswap/uikit'\nimport { connectorsByName } from 'utils/web3React'\nimport { setupNetwork } from 'utils/wallet'\nimport useToast from 'hooks/useToast'\nimport { profileClear } from 'state/profile'\nimport { useAppDispatch } from 'state'\n\nconst useAuth = () => {\n  const dispatch = useAppDispatch()\n  const { activate, deactivate } = useWeb3React()\n  const { toastError } = useToast()\n\n  const login = useCallback(\n    (connectorID: ConnectorNames) => {\n      const connector = connectorsByName[connectorID]\n      if (connector) {\n        activate(connector, async (error: Error) => {\n          if (error instanceof UnsupportedChainIdError) {\n            const hasSetup = await setupNetwork()\n            if (hasSetup) {\n              activate(connector)\n            }\n          } else {\n            window.localStorage.removeItem(connectorLocalStorageKey)\n            if (error instanceof NoEthereumProviderError || error instanceof NoBscProviderError) {\n              toastError('Provider Error', 'No provider was found')\n            } else if (\n              error instanceof UserRejectedRequestErrorInjected ||\n              error instanceof UserRejectedRequestErrorWalletConnect\n            ) {\n              if (connector instanceof WalletConnectConnector) {\n                const walletConnector = connector as WalletConnectConnector\n                walletConnector.walletConnectProvider = null\n              }\n              toastError('Authorization Error', 'Please authorize to access your account')\n            } else {\n              toastError(error.name, error.message)\n            }\n          }\n        })\n      } else {\n        toastError('Unable to find connector', 'The connector config is wrong')\n      }\n    },\n    [ activate, toastError],\n  )\n\n  const logout = useCallback(() => {\n    dispatch(profileClear())\n    deactivate()\n    // This localStorage key is set by @web3-react/walletconnect-connector\n    if (window.localStorage.getItem('walletconnect')) {\n      connectorsByName.walletconnect.close()\n      connectorsByName.walletconnect.walletConnectProvider = null\n    }\n  }, [deactivate, dispatch])\n\n  return { login, logout }\n}\n\nexport default useAuth\n"]},"metadata":{},"sourceType":"module"}