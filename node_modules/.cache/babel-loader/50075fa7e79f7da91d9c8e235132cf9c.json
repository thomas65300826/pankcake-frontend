{"ast":null,"code":"import { ethers } from 'ethers';\n/**\n * Estimate the gas needed to call a function, and add a 10% margin\n * @param contract Used to perform the call\n * @param methodName The name of the methode called\n * @param gasMarginPer10000 The gasMargin per 10000 (i.e. 10% -> 1000)\n * @param args An array of arguments to pass to the method\n * @returns https://docs.ethers.io/v5/api/providers/types/#providers-TransactionReceipt\n */\n\nexport const estimateGas = async (contract, methodName, methodArgs, gasMarginPer10000) => {\n  if (!contract[methodName]) {\n    throw new Error(`Method ${methodName} doesn't exist on ${contract.address}`);\n  }\n\n  const rawGasEstimation = await contract.estimateGas[methodName](...methodArgs); // By convention, ethers.BigNumber values are multiplied by 1000 to avoid dealing with real numbers\n\n  const gasEstimation = rawGasEstimation.mul(ethers.BigNumber.from(10000).add(ethers.BigNumber.from(gasMarginPer10000))).div(ethers.BigNumber.from(10000));\n  return gasEstimation;\n};\n/**\n * Perform a contract call with a gas value returned from estimateGas\n * @param contract Used to perform the call\n * @param methodName The name of the methode called\n * @param args An array of arguments to pass to the method\n * @returns https://docs.ethers.io/v5/api/providers/types/#providers-TransactionReceipt\n */\n\nexport const callWithEstimateGas = async (contract, methodName, methodArgs = [], gasMarginPer10000 = 1000) => {\n  const gasEstimation = estimateGas(contract, methodName, methodArgs, gasMarginPer10000);\n  const tx = await contract[methodName](...methodArgs, {\n    gasLimit: gasEstimation\n  });\n  return tx;\n};","map":{"version":3,"sources":["/Users/thomas/Documents/pancake-frontend/pankcake-frontend/src/utils/calls/estimateGas.ts"],"names":["ethers","estimateGas","contract","methodName","methodArgs","gasMarginPer10000","Error","address","rawGasEstimation","gasEstimation","mul","BigNumber","from","add","div","callWithEstimateGas","tx","gasLimit"],"mappings":"AAAA,SAASA,MAAT,QAAiC,QAAjC;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,OAAO,MAAMC,WAAW,GAAG,OACzBC,QADyB,EAEzBC,UAFyB,EAGzBC,UAHyB,EAIzBC,iBAJyB,KAKtB;AACH,MAAI,CAACH,QAAQ,CAACC,UAAD,CAAb,EAA2B;AACzB,UAAM,IAAIG,KAAJ,CAAW,UAASH,UAAW,qBAAoBD,QAAQ,CAACK,OAAQ,EAApE,CAAN;AACD;;AACD,QAAMC,gBAAgB,GAAG,MAAMN,QAAQ,CAACD,WAAT,CAAqBE,UAArB,EAAiC,GAAGC,UAApC,CAA/B,CAJG,CAKH;;AACA,QAAMK,aAAa,GAAGD,gBAAgB,CACnCE,GADmB,CACfV,MAAM,CAACW,SAAP,CAAiBC,IAAjB,CAAsB,KAAtB,EAA6BC,GAA7B,CAAiCb,MAAM,CAACW,SAAP,CAAiBC,IAAjB,CAAsBP,iBAAtB,CAAjC,CADe,EAEnBS,GAFmB,CAEfd,MAAM,CAACW,SAAP,CAAiBC,IAAjB,CAAsB,KAAtB,CAFe,CAAtB;AAGA,SAAOH,aAAP;AACD,CAfM;AAiBP;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,OAAO,MAAMM,mBAAmB,GAAG,OACjCb,QADiC,EAEjCC,UAFiC,EAGjCC,UAAiB,GAAG,EAHa,EAIjCC,iBAAiB,GAAG,IAJa,KAKiB;AAClD,QAAMI,aAAa,GAAGR,WAAW,CAACC,QAAD,EAAWC,UAAX,EAAuBC,UAAvB,EAAmCC,iBAAnC,CAAjC;AACA,QAAMW,EAAE,GAAG,MAAMd,QAAQ,CAACC,UAAD,CAAR,CAAqB,GAAGC,UAAxB,EAAoC;AACnDa,IAAAA,QAAQ,EAAER;AADyC,GAApC,CAAjB;AAGA,SAAOO,EAAP;AACD,CAXM","sourcesContent":["import { ethers, Contract } from 'ethers'\n\n/**\n * Estimate the gas needed to call a function, and add a 10% margin\n * @param contract Used to perform the call\n * @param methodName The name of the methode called\n * @param gasMarginPer10000 The gasMargin per 10000 (i.e. 10% -> 1000)\n * @param args An array of arguments to pass to the method\n * @returns https://docs.ethers.io/v5/api/providers/types/#providers-TransactionReceipt\n */\nexport const estimateGas = async (\n  contract: Contract,\n  methodName: string,\n  methodArgs: any[],\n  gasMarginPer10000: number,\n) => {\n  if (!contract[methodName]) {\n    throw new Error(`Method ${methodName} doesn't exist on ${contract.address}`)\n  }\n  const rawGasEstimation = await contract.estimateGas[methodName](...methodArgs)\n  // By convention, ethers.BigNumber values are multiplied by 1000 to avoid dealing with real numbers\n  const gasEstimation = rawGasEstimation\n    .mul(ethers.BigNumber.from(10000).add(ethers.BigNumber.from(gasMarginPer10000)))\n    .div(ethers.BigNumber.from(10000))\n  return gasEstimation\n}\n\n/**\n * Perform a contract call with a gas value returned from estimateGas\n * @param contract Used to perform the call\n * @param methodName The name of the methode called\n * @param args An array of arguments to pass to the method\n * @returns https://docs.ethers.io/v5/api/providers/types/#providers-TransactionReceipt\n */\nexport const callWithEstimateGas = async (\n  contract: Contract,\n  methodName: string,\n  methodArgs: any[] = [],\n  gasMarginPer10000 = 1000,\n): Promise<ethers.providers.TransactionResponse> => {\n  const gasEstimation = estimateGas(contract, methodName, methodArgs, gasMarginPer10000)\n  const tx = await contract[methodName](...methodArgs, {\n    gasLimit: gasEstimation,\n  })\n  return tx\n}\n"]},"metadata":{},"sourceType":"module"}